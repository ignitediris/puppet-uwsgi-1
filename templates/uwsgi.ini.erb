#
# This file is managed by puppet class 'uwsgi'
#
# uWSGI main process configuration
#
[uwsgi]
<% if scope.lookupvar('uwsgi::socket') -%>
socket = <%= scope.lookupvar('uwsgi::socket') %>
<% end -%>
<% if scope.lookupvar('uwsgi::plugins_directory') -%>
plugin-dir <%= scope.lookupvar('uwsgi::plugins_directory') %>
<% end -%>
pidfile = <%= scope.lookupvar('uwsgi::pid_file') %>
emperor = <%= scope.lookupvar('uwsgi::app_directory') %>
emperor-tyrant = <%= scope.lookupvar('uwsgi::tyrant') %>
master = true
autoload = true
log-date = true
no-orphans = true
<% if scope.lookupvar('uwsgi::log_file') -%>
logto = <%= scope.lookupvar('uwsgi::log_file') %>
<% end -%>
<% if @os['family'] == 'Debian' -%>
uid = <%= scope.lookupvar('uwsgi::user_real') %>
gid = <%= scope.lookupvar('uwsgi::group_real') %>
<% end -%>
<%
if scope.lookupvar('uwsgi::emperor_options')
  scope.lookupvar('uwsgi::emperor_options').each do |key, value|
-%>
<%= key %> = <%= value%>
<%
  end
end
-%>
